export const LANG_KEY = 'app_lang';
export const LANGUAGES = [
  { code: 'uz', label: 'Oʻzbek' },
  { code: 'ru', label: 'Русский' },
  { code: 'en', label: 'English' },
];

const translations = {
  uz: {
    app: { loading: 'Yuklanmoqda...', telegramOnly: 'Bu ilova faqat Telegram orqali ishlatiladi. Bot orqali kirishingiz kerak.' },
    layout: { appName: 'Bosh sahifa' },
    nav: { home: 'Bosh sahifa', books: 'Kitoblar', profile: 'Profil', aria: 'Asosiy menyu' },
    home: {
      heroTitle: 'Yangi kitoblarni kashf eting',
      heroSub: 'Istalgan joyda, istalgan vaqtda o‘qing.',
      continueReading: 'Davom etish',
      popularBooks: 'Kitoblar',
      welcomeHint: 'Kategoriyani tanlang yoki',
      booksLink: 'Kitoblar',
      welcomeHint2: 'bo‘limida barcha kitoblarni ko‘ring.',
      categories: 'Kategoriyalar',
      loading: 'Yuklanmoqda...',
      error: 'Xatolik',
      noCategories: 'Hali kategoriya yoʻq. Admin paneldan qoʻshing.',
      authError: 'Kirish tasdiqlanmadi. Botda «Kitobxonga o\'tish» tugmasini qayta bosing.',
      noContinueReading: 'Hali o‘qish progressi yo‘q. Kitob tanlang.',
    },
    books: {
      title: 'Kitoblar',
      all: 'Barchasi',
      search: 'Qidirish',
      searchPlaceholder: 'Kitob yoki muallif...',
      loading: 'Yuklanmoqda...',
      error: 'Xatolik',
      noBooks: 'Bu boʻlimda hali kitob yoʻq.',
      noResults: 'Hech narsa topilmadi.',
      pages: 'sahifa',
    },
    profile: {
      title: 'Profil',
      settings: 'Sozlamalar',
      language: 'Til',
      login: 'Kirish',
      loginDesc: 'Telegram orqali tasdiqlandi. Maʼlumotlaringiz faqat kitob progressini saqlash uchun ishlatiladi.',
      devMode: 'Dev rejim (lokal test)',
      app: 'Ilova',
      appDesc: 'Kitobxona – PDF kitoblarni o‘qish. Kategoriyalar va kitoblar bosh sahifada va Kitoblar bo‘limida.',
      toHome: 'Bosh sahifaga',
    },
    bookDetail: {
      read: 'O‘qish',
      pages: 'sahifa',
      back: 'Orqaga',
      pageTitle: 'Kitob',
    },
    reader: { pageTitle: 'O‘qish',
      exit: 'Chiqish',
      back: 'Orqaga',
      menuAria: 'Menyu',
      zoomOut: 'Kichiklashtirish',
      zoomIn: 'Kattalashtirish',
      sepia: 'Sepia',
      light: 'Oq',
      dark: 'Qora',
      prevPage: 'Oldingi',
      nextPage: 'Keyingi',
      bookLoading: 'Kitob yuklanmoqda...',
      pdfJsError: 'PDF.js yuklanmadi. Internetingizni tekshiring.',
      pdfError: 'PDF yuklanmadi',
      pageAria: 'Sahifa: chap/o‘ng bosing, suring yoki markazda bosing – panel yashirish',
    },
  },
  ru: {
    app: { loading: 'Загрузка...', telegramOnly: 'Это приложение работает только через Telegram. Войдите через бота.' },
    layout: { appName: 'Главная' },
    nav: { home: 'Главная', books: 'Книги', profile: 'Профиль', aria: 'Главное меню' },
    home: {
      heroTitle: 'Откройте новые книги',
      heroSub: 'Читайте где угодно, когда угодно.',
      continueReading: 'Продолжить',
      popularBooks: 'Книги',
      welcomeHint: 'Выберите категорию или',
      booksLink: 'Книги',
      welcomeHint2: 'чтобы увидеть все книги.',
      categories: 'Категории',
      loading: 'Загрузка...',
      error: 'Ошибка',
      noCategories: 'Пока нет категорий. Добавьте в админ-панели.',
      authError: 'Вход не подтверждён. Нажмите «Перейти в библиотеку» в боте снова.',
      noContinueReading: 'Нет прогресса. Выберите книгу.',
    },
    books: {
      title: 'Книги',
      all: 'Все',
      search: 'Поиск',
      searchPlaceholder: 'Книга или автор...',
      loading: 'Загрузка...',
      error: 'Ошибка',
      noBooks: 'В этом разделе пока нет книг.',
      noResults: 'Ничего не найдено.',
      pages: 'стр.',
    },
    profile: {
      title: 'Профиль',
      settings: 'Настройки',
      language: 'Язык',
      login: 'Вход',
      loginDesc: 'Подтверждено через Telegram. Ваши данные используются только для сохранения прогресса чтения.',
      devMode: 'Режим разработки (локальный тест)',
      app: 'Приложение',
      appDesc: 'Библиотека – чтение PDF. Категории и книги на главной и в разделе «Книги».',
      toHome: 'На главную',
    },
    bookDetail: {
      read: 'Читать',
      pages: 'стр.',
      back: 'Назад',
      pageTitle: 'Книга',
    },
    reader: { pageTitle: 'Чтение',
      exit: 'Выход',
      back: 'Назад',
      menuAria: 'Меню',
      zoomOut: 'Уменьшить',
      zoomIn: 'Увеличить',
      sepia: 'Сепия',
      light: 'Светлая',
      dark: 'Тёмная',
      prevPage: 'Назад',
      nextPage: 'Вперёд',
      bookLoading: 'Загрузка книги...',
      pdfJsError: 'PDF.js не загрузился. Проверьте интернет.',
      pdfError: 'PDF не загружен',
      pageAria: 'Страница: нажмите влево/вправо, свайп или по центру – скрыть панель',
    },
  },
  en: {
    app: { loading: 'Loading...', telegramOnly: 'This app only works via Telegram. Please open it from the bot.' },
    layout: { appName: 'Home' },
    nav: { home: 'Home', books: 'Books', profile: 'Profile', aria: 'Main menu' },
    home: {
      heroTitle: 'Explore new books',
      heroSub: 'Read anytime, anywhere.',
      continueReading: 'Continue Reading',
      popularBooks: 'Books',
      welcomeHint: 'Choose a category or open',
      booksLink: 'Books',
      welcomeHint2: 'to see all books.',
      categories: 'Categories',
      loading: 'Loading...',
      error: 'Error',
      noCategories: 'No categories yet. Add them in the admin panel.',
      authError: 'Sign-in not verified. Tap «Go to library» in the bot again.',
      noContinueReading: 'No progress yet. Pick a book.',
    },
    books: {
      title: 'Books',
      all: 'All',
      search: 'Search',
      searchPlaceholder: 'Book or author...',
      loading: 'Loading...',
      error: 'Error',
      noBooks: 'No books in this section yet.',
      noResults: 'No results found.',
      pages: 'p.',
    },
    profile: {
      title: 'Profile',
      settings: 'Settings',
      language: 'Language',
      login: 'Sign in',
      loginDesc: 'Verified via Telegram. Your data is only used to save reading progress.',
      devMode: 'Dev mode (local test)',
      app: 'App',
      appDesc: 'Library – read PDF books. Categories and books on Home and in Books.',
      toHome: 'To Home',
    },
    bookDetail: {
      read: 'Read',
      pages: 'p.',
      back: 'Back',
      pageTitle: 'Book',
    },
    reader: { pageTitle: 'Reader',
      exit: 'Exit',
      back: 'Back',
      menuAria: 'Menu',
      zoomOut: 'Zoom out',
      zoomIn: 'Zoom in',
      sepia: 'Sepia',
      light: 'Light',
      dark: 'Dark',
      prevPage: 'Prev',
      nextPage: 'Next',
      bookLoading: 'Loading book...',
      pdfJsError: 'PDF.js failed to load. Check your connection.',
      pdfError: 'PDF failed to load',
      pageAria: 'Page: tap left/right, swipe, or center to toggle panel',
    },
  },
};

export function getT(lang) {
  const dict = translations[lang] || translations.uz;
  return (key) => {
    const parts = key.split('.');
    let v = dict;
    for (const p of parts) {
      v = v?.[p];
      if (v === undefined) return key;
    }
    return typeof v === 'string' ? v : key;
  };
}
